/*****************************************************************************
* File    : GC_eeprom.ino
* Author  : 惜枫醉
* Date    : 2017/05/22
* Brief   : eeprom 操作
*
* Copyright (c) 2000-2020 惜枫醉 All Rights Reserved.
* Remarks :修改日志
******************************************************************************/


/*****************************************************************************
*                               头文件引用
******************************************************************************/
#include "GC_eeprom.h"

/*****************************************************************************
*                                常量定义
******************************************************************************/


/*****************************************************************************
*                                 宏定义
******************************************************************************/

/*****************************************************************************
*                              数据类型定义
******************************************************************************/


/*****************************************************************************
*                                函数声明
******************************************************************************/


/*****************************************************************************
*                                变量定义
******************************************************************************/



/*****************************************************************************
* Author  : 惜枫醉
* Date    : 2017/05/28
* Brief   : 存储
* param addr
* param val
* Return  : 
* Remarks : 
******************************************************************************/
Int8 EEPROM_store(int addr, int val)
{
    //Serial.print("store:");
    //Serial.println(val,DEC);
    EEPROM.write(addr,val);
}


/*****************************************************************************
* Author  : 惜枫醉
* Date    : 2017/05/28
* Brief   : 获取
* param addr
* Return  : 
* Remarks : 
******************************************************************************/
Uint8 EEPROM_restore(int addr)
{
    Uint8 ret = 0;
    //Serial.print("restore:");
    ret = EEPROM.read(addr);
   // Serial.println(ret,DEC);
    return ret;
}

/*****************************************************************************
* Author  : 惜枫醉
* Date    : 2017/05/28
* Brief   : 初始化
* Return  : 
* Remarks : 
******************************************************************************/
Int8 EEPROM_init(void)
{
    Int8 ii = 0;
    Uint8 version = 0x00;
    version = EEPROM_restore(EEPROM_INFO);
    if(version != EEPROM_VERSION)//版本判断，如果版本有问题则会重新擦写以便eeprom
    {
        for(ii = 1; ii<EEPROM_USEDSIZE; ii++)
        {
            EEPROM_store(ii,0);
        }
        EEPROM_store(EEPROM_INFO,EEPROM_VERSION);
    }
}



